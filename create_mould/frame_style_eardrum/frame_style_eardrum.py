import bpy
import bmesh

from ..dig_hole import dig_hole
from ..border_fill import fill_frame_style_inner_face
from ..normal_projection import frame_normal_projection_to_darw_cut_plane
from ...tool import moveToRight, convert_to_mesh
from ...utils.utils import *

border_vert_co_and_normal = [
        ((-3.6916444301605225, 8.6956148147583, -3.810093641281128),
         (-0.7966533303260803, -0.10662736743688583, -0.5949571132659912)),
        ((-3.3809030055999756, 8.374272346496582, -4.0954766273498535),
         (-0.6736541390419006, -0.185792937874794, -0.7153118848800659)),
        ((13.306536674499512, -5.8895697593688965, -5.714186668395996),
         (-0.0031149201095104218, -0.22585536539554596, -0.974155843257904)), (
        (13.09268856048584, -6.323978424072266, -5.603431224822998),
        (0.007304081227630377, -0.268837571144104, -0.9631578326225281)), (
        (-6.935081481933594, -13.520472526550293, -4.506632328033447),
        (-0.2680089771747589, -0.6690917611122131, -0.693172037601471)), (
        (-6.42642068862915, -7.620792865753174, -6.003060340881348),
        (0.038726091384887695, -0.1052844449877739, -0.9936878681182861)), (
        (-6.518202304840088, -8.127269744873047, -5.969344139099121),
        (-0.013047886081039906, -0.08475624769926071, -0.9963163733482361)), (
        (15.397491455078125, 1.3811067342758179, -6.639054775238037),
        (0.29204535484313965, -0.2884875237941742, -0.9118576645851135)), (
        (12.664124488830566, -6.890064239501953, -5.4441962242126465),
        (-0.04317208379507065, -0.3005923330783844, -0.9527751207351685)), (
        (-3.7880446910858154, 2.7042014598846436, -5.940113067626953),
        (-0.2427949607372284, 0.7635230422019958, -0.5984005331993103)), (
        (-4.103152751922607, 2.5893826484680176, -5.936269283294678),
        (-0.2209039032459259, 0.6706976890563965, -0.7080720067024231)), (
        (3.717918872833252, -11.19593620300293, -3.9501760005950928),
        (0.18694885075092316, -0.19792664051055908, -0.9622240662574768)), (
        (4.241807460784912, -11.128814697265625, -3.8831946849823),
        (0.1030072495341301, -0.198526531457901, -0.974667489528656)), (
        (-5.291518688201904, 1.8575083017349243, -6.307031154632568),
        (0.0056350501254200935, 0.5949352383613586, -0.8037537932395935)), (
        (-5.5874223709106445, 1.4947807788848877, -6.588447093963623),
        (0.02103206142783165, 0.512485682964325, -0.8584381341934204)), (
        (0.9260059595108032, 4.90950870513916, -6.583316802978516),
        (-0.8595861792564392, 0.4583653509616852, -0.22585998475551605)), (
        (0.7094436883926392, 4.57454776763916, -6.754184722900391),
        (-0.7473675012588501, 0.647135853767395, -0.15052242577075958)), (
        (8.62091064453125, -10.279671669006348, -4.3546953201293945),
        (-0.07663502544164658, -0.13396024703979492, -0.9880191087722778)), (
        (9.058389663696289, -10.019227027893066, -4.413699626922607),
        (-0.06564082205295563, -0.13456693291664124, -0.9887279868125916)), (
        (14.69507122039795, 6.763702869415283, -6.635896682739258),
        (0.3818292021751404, 0.4514085054397583, -0.8064966201782227)), (
        (5.446869373321533, 13.427602767944336, -6.23151969909668),
        (-0.013842619024217129, 0.27666768431663513, -0.9608659744262695)), (
        (5.925361633300781, 13.149526596069336, -6.308176040649414),
        (0.011295887641608715, 0.249200239777565, -0.9683861136436462)), (
        (2.8517005443573, 14.997855186462402, -5.365652561187744),
        (-0.028974222019314766, 0.6845568418502808, -0.7283833622932434)), (
        (-7.353706359863281, -10.982269287109375, -5.643916606903076),
        (-0.3020470142364502, -0.11424494534730911, -0.9464225769042969)), (
        (-7.421008586883545, -11.292582511901855, -5.587276458740234),
        (-0.3399485647678375, -0.18091706931591034, -0.922878086566925)), (
        (-3.205118179321289, 2.7885830402374268, -6.057971000671387),
        (-0.22698910534381866, 0.7858757972717285, -0.5752174854278564)), (
        (2.4546756744384766, 15.16889476776123, -5.181893348693848),
        (-0.08865316957235336, 0.7475902438163757, -0.6582168340682983)), (
        (13.5491304397583, 7.9952006340026855, -6.417795181274414),
        (0.2893212139606476, 0.47213736176490784, -0.8326941728591919)), (
        (13.210657119750977, 8.264055252075195, -6.37751579284668),
        (0.27293524146080017, 0.46220242977142334, -0.8437271118164062)), (
        (15.385055541992188, 5.104590892791748, -7.077293872833252),
        (0.3874160349369049, 0.26027533411979675, -0.884401261806488)), (
        (-3.919257879257202, 9.075385093688965, -3.5313220024108887),
        (-0.8604093194007874, -0.06655056029558182, -0.5052394866943359)), (
        (9.316770553588867, -9.818811416625977, -4.461415767669678),
        (-0.08705982565879822, -0.11321935057640076, -0.989748477935791)), (
        (9.575151443481445, -9.618395805358887, -4.509131908416748),
        (-0.0789598822593689, -0.14036740362644196, -0.9869459867477417)), (
        (12.878405570983887, -6.607021331787109, -5.5238142013549805),
        (-0.03640575706958771, -0.23895052075386047, -0.970349133014679)), (
        (13.497801780700684, -5.453325271606445, -5.805058002471924),
        (0.018108760938048363, -0.19094142317771912, -0.9814344048500061)), (
        (13.767343521118164, -4.810052394866943, -5.9145402908325195),
        (0.04252035543322563, -0.1612301915884018, -0.9860004782676697)), (
        (13.63257122039795, -5.131689071655273, -5.859799385070801),
        (0.029688086360692978, -0.17765648663043976, -0.9836446046829224)), (
        (14.015840530395508, -4.243525505065918, -5.985100269317627),
        (0.09916635602712631, -0.1289113610982895, -0.9866852760314941)), (
        (14.251666069030762, -3.6299335956573486, -6.02722692489624),
        (0.11019431054592133, -0.1007862240076065, -0.9887868165969849)), (
        (14.133752822875977, -3.936729669570923, -6.006163597106934),
        (0.10287860780954361, -0.10675039142370224, -0.988949179649353)), (
        (14.468205451965332, -3.076077699661255, -6.0517048835754395),
        (0.13812211155891418, -0.08100603520870209, -0.9870969653129578)), (
        (14.656460762023926, -2.5544729232788086, -6.063515663146973),
        (0.16011345386505127, -0.07424736768007278, -0.9843022227287292)), (
        (14.852493286132812, -1.9437276124954224, -6.069851875305176),
        (0.20059771835803986, -0.0781976580619812, -0.9765478372573853)), (
        (14.754477500915527, -2.2491002082824707, -6.066683769226074),
        (0.17250850796699524, -0.06101684272289276, -0.9831162691116333)), (
        (14.988574028015137, -1.429298758506775, -6.0789690017700195),
        (0.21648162603378296, -0.09503310173749924, -0.9716503024101257)), (
        (15.120471000671387, -0.8218900561332703, -6.125232219696045),
        (0.232815220952034, -0.1599799394607544, -0.9592723846435547)), (
        (15.19726848602295, -0.3001768887042999, -6.216426372528076),
        (0.2283736914396286, -0.20946721732616425, -0.9507728219032288)), (
        (15.251904487609863, 0.15033407509326935, -6.308818340301514),
        (0.23539872467517853, -0.25458824634552, -0.9379618167877197)), (
        (15.301040649414062, 0.606304407119751, -6.427972316741943),
        (0.2517433762550354, -0.27715879678726196, -0.9272585511207581)), (
        (15.355938911437988, 1.0682933330535889, -6.552335262298584),
        (0.2789860665798187, -0.28445231914520264, -0.917198896408081)), (
        (15.439043045043945, 1.6939201354980469, -6.725773811340332),
        (0.3022967576980591, -0.2826397716999054, -0.9103468656539917)), (
        (15.525835037231445, 2.4168930053710938, -6.908332347869873),
        (0.33655020594596863, -0.22782820463180542, -0.913689374923706)), (
        (15.482439041137695, 2.0554068088531494, -6.817053318023682),
        (0.3120071291923523, -0.2632584571838379, -0.9128782153129578)), (
        (15.564772605895996, 2.9430480003356934, -7.008388996124268),
        (0.37764492630958557, -0.15897496044635773, -0.9122013449668884)), (
        (15.565176963806152, 3.6458444595336914, -7.107742786407471),
        (0.3963403105735779, -0.07899447530508041, -0.9146990180015564)), (
        (15.564974784851074, 3.2944462299346924, -7.058066368103027),
        (0.37250593304634094, -0.12967316806316376, -0.9189257025718689)), (
        (15.514050483703613, 4.2422685623168945, -7.152979850769043),
        (0.4093541204929352, 0.03466130048036575, -0.911716878414154)), (
        (15.458035469055176, 4.644193649291992, -7.140054702758789),
        (0.3891081213951111, 0.13040240108966827, -0.9119156002998352)), (
        (15.276824951171875, 5.562228202819824, -6.960997581481934),
        (0.4075985848903656, 0.3506464660167694, -0.8431550860404968)), (
        (15.145044326782227, 5.934391021728516, -6.857550621032715),
        (0.4008673429489136, 0.40317854285240173, -0.8226495981216431)), (
        (14.958012580871582, 6.3167500495910645, -6.750768184661865),
        (0.38262197375297546, 0.4306630790233612, -0.817392110824585)), (
        (14.399347305297852, 7.179637432098389, -6.546294212341309),
        (0.40452826023101807, 0.4603087902069092, -0.7902357578277588)), (
        (14.008864402770996, 7.593435287475586, -6.480569839477539),
        (0.33376479148864746, 0.4671248495578766, -0.8187767863273621)), (
        (12.729549407958984, 8.605428695678711, -6.337126731872559),
        (0.23519767820835114, 0.44050195813179016, -0.8663948178291321)), (
        (12.226119995117188, 8.948400497436523, -6.296384334564209),
        (0.22830283641815186, 0.424355149269104, -0.8762422800064087)), (
        (11.841256141662598, 9.197643280029297, -6.277912616729736),
        (0.22612448036670685, 0.3900949954986572, -0.8925769329071045)), (
        (11.33975601196289, 9.525345802307129, -6.268913745880127),
        (0.23696430027484894, 0.3653469979763031, -0.9002051949501038)), (
        (10.806117057800293, 9.87354850769043, -6.279690265655518),
        (0.2404005080461502, 0.3252725601196289, -0.9145520329475403)), (
        (10.426429748535156, 10.133564949035645, -6.291011333465576),
        (0.26108211278915405, 0.277248352766037, -0.9246455430984497)), (
        (10.076350212097168, 10.382973670959473, -6.325659275054932),
        (0.26587504148483276, 0.23968194425106049, -0.9337360858917236)), (
        (9.655067443847656, 10.688039779663086, -6.365099906921387),
        (0.2592304050922394, 0.22519153356552124, -0.9391955733299255)), (
        (9.086807250976562, 11.096123695373535, -6.4229912757873535),
        (0.24329744279384613, 0.22237610816955566, -0.9441161751747131)), (
        (9.37093734741211, 10.892081260681152, -6.394045352935791),
        (0.25335627794265747, 0.21365487575531006, -0.9434840083122253)), (
        (8.641408920288086, 11.40377140045166, -6.454433917999268),
        (0.20069116353988647, 0.22051680088043213, -0.9545130729675293)), (
        (7.996158123016357, 11.856390953063965, -6.476990699768066),
        (0.14207790791988373, 0.20696943998336792, -0.9679759740829468)), (
        (8.3187837600708, 11.630081176757812, -6.465712070465088),
        (0.1838359236717224, 0.19701515138149261, -0.9630105495452881)), (
        (7.531126499176025, 12.187920570373535, -6.454187870025635),
        (0.10973230004310608, 0.2373039722442627, -0.9652178883552551)), (
        (7.004680633544922, 12.534635543823242, -6.417690753936768),
        (0.08403966575860977, 0.2762770652770996, -0.9573965668678284)), (
        (6.326045513153076, 12.925848007202148, -6.357517719268799),
        (0.040696002542972565, 0.24189139902591705, -0.9694495797157288)), (
        (6.66536283493042, 12.730241775512695, -6.387604236602783),
        (0.06551463901996613, 0.238918274641037, -0.9688271284103394)), (
        (4.863846778869629, 13.787590980529785, -6.101531982421875),
        (-0.03485426306724548, 0.32748785614967346, -0.9442123174667358)), (
        (5.15535831451416, 13.607596397399902, -6.166525363922119),
        (-0.02419629693031311, 0.30908381938934326, -0.9507269859313965)), (
        (4.411404609680176, 14.071084022521973, -5.972622871398926),
        (-0.04471580684185028, 0.3905743360519409, -0.9194847345352173)), (
        (4.085301876068115, 14.279031753540039, -5.872753143310547),
        (0.013066046871244907, 0.44212526082992554, -0.8968582153320312)), (
        (3.6860408782958984, 14.537758827209473, -5.72934627532959),
        (-0.003958249930292368, 0.5363315343856812, -0.8439981341362)), (
        (3.360055685043335, 14.73710823059082, -5.594220161437988),
        (-0.0003290957538411021, 0.6009325981140137, -0.7992997169494629)), (
        (1.8314259052276611, 15.341811180114746, -4.8248724937438965),
        (-0.19655382633209229, 0.8183718323707581, -0.5400317311286926)), (
        (2.1430509090423584, 15.255352973937988, -5.003382682800293),
        (-0.15634068846702576, 0.7804295420646667, -0.6053818464279175)), (
        (1.4135136604309082, 15.390230178833008, -4.490506172180176),
        (-0.31235015392303467, 0.876169741153717, -0.36710232496261597)), (
        (0.9901033639907837, 15.338482856750488, -4.154697418212891),
        (-0.3172990679740906, 0.9104175567626953, -0.2654455304145813)), (
        (0.5078386664390564, 15.243048667907715, -3.9218192100524902),
        (-0.29706260561943054, 0.9144459962844849, -0.27484965324401855)), (
        (-0.11367855221033096, 15.115622520446777, -3.7099928855895996),
        (-0.36688584089279175, 0.8931063413619995, -0.26029935479164124)), (
        (0.19708004593849182, 15.179335594177246, -3.815906047821045),
        (-0.2956447899341583, 0.91045743227005, -0.28924286365509033)), (
        (-0.5847912430763245, 14.93114185333252, -3.4778859615325928),
        (-0.48681530356407166, 0.857461154460907, -0.16664664447307587)), (
        (-1.0630874633789062, 14.678736686706543, -3.215823173522949),
        (-0.546110212802887, 0.8340674638748169, -0.07807137817144394)), (
        (-1.436532974243164, 14.432154655456543, -3.031360626220703),
        (-0.5789718627929688, 0.8129338622093201, -0.06269044429063797)), (
        (-1.8914464712142944, 14.106386184692383, -2.832854986190796),
        (-0.6172764897346497, 0.7851894497871399, -0.049470387399196625)), (
        (-2.3544259071350098, 13.733508110046387, -2.675690174102783),
        (-0.6476678848266602, 0.7618686556816101, -0.00907797273248434)), (
        (-2.869800567626953, 13.259477615356445, -2.5896222591400146),
        (-0.7120678424835205, 0.7012092471122742, -0.03556695953011513)), (
        (-2.6121132373809814, 13.496493339538574, -2.6326560974121094),
        (-0.6766310930252075, 0.7335811257362366, -0.0634760707616806)), (
        (-3.312136173248291, 12.767255783081055, -2.5746946334838867),
        (-0.7810474038124084, 0.6200759410858154, -0.07396484911441803)), (
        (-3.090968370437622, 13.01336669921875, -2.582158327102661),
        (-0.7388120889663696, 0.6694618463516235, -0.07731455564498901)), (
        (-3.658174991607666, 12.294032096862793, -2.616373062133789),
        (-0.8515339493751526, 0.5150896906852722, -0.09783951938152313)), (
        (-3.908780813217163, 11.84496784210205, -2.7010488510131836),
        (-0.8724278211593628, 0.4597966969013214, -0.16570045053958893)), (
        (-4.060799598693848, 11.446060180664062, -2.781268835067749),
        (-0.9093069434165955, 0.3375420868396759, -0.24336448311805725)), (
        (-4.155004501342773, 11.012839317321777, -2.852635145187378),
        (-0.9494574069976807, 0.18086016178131104, -0.25655436515808105)), (
        (-4.1818742752075195, 10.462800979614258, -2.9575114250183105),
        (-0.9556730389595032, 0.07291796058416367, -0.2852577567100525)), (
        (-4.1603875160217285, 9.977638244628906, -3.0848426818847656),
        (-0.9461425542831421, 0.014311028644442558, -0.3234337270259857)), (
        (-4.067920207977295, 9.4597806930542, -3.3008170127868652),
        (-0.9086523652076721, -0.029607223346829414, -0.41650253534317017)), (
        (-2.845214366912842, 8.083857536315918, -4.400768280029297),
        (-0.5231507420539856, -0.2532101571559906, -0.8137555122375488)), (
        (-3.113058567047119, 8.22906494140625, -4.248122692108154),
        (-0.5613251328468323, -0.19191594421863556, -0.8050355911254883)), (
        (-2.349372625350952, 7.910211563110352, -4.577332973480225),
        (-0.3830653131008148, -0.2795068621635437, -0.8804185390472412)), (
        (-1.963693618774414, 7.7979655265808105, -4.693563461303711),
        (-0.35818570852279663, -0.27158570289611816, -0.8932772278785706)), (
        (-1.543560266494751, 7.675747871398926, -4.821074485778809),
        (-0.3447515070438385, -0.25559794902801514, -0.9032253623008728)), (
        (-1.0717955827713013, 7.546049118041992, -4.963476181030273),
        (-0.40760618448257446, -0.18868744373321533, -0.8934507966041565)), (
        (-0.6275960803031921, 7.375473976135254, -5.15614128112793),
        (-0.4868571162223816, -0.08587217330932617, -0.8692502975463867)), (
        (-0.0008672714466229081, 6.99412202835083, -5.537491798400879),
        (-0.5214946866035461, -0.028920453041791916, -0.8527643084526062)), (
        (-0.3142316937446594, 7.184798240661621, -5.3468170166015625),
        (-0.5463706254959106, -0.07437144964933395, -0.8342350125312805)), (
        (0.507379949092865, 6.5226545333862305, -5.8350443840026855),
        (-0.5796027183532715, -0.009207255207002163, -0.8148472309112549)), (
        (0.25325635075569153, 6.758388042449951, -5.686267852783203),
        (-0.5443052649497986, -0.0860685259103775, -0.8344602584838867)), (
        (0.8972234129905701, 5.884597301483154, -6.134481430053711),
        (-0.7573294639587402, -0.003928242716938257, -0.6530211567878723)), (
        (0.7023016810417175, 6.203625679016113, -5.984762668609619),
        (-0.6589189767837524, -0.1109730526804924, -0.7439831495285034)), (
        (1.00902259349823, 5.296072959899902, -6.3913493156433105),
        (-0.8859135508537292, 0.1959928721189499, -0.4204091727733612)), (
        (0.9531229138374329, 5.590335369110107, -6.262915134429932),
        (-0.8426186442375183, 0.052389129996299744, -0.5359562635421753)), (
        (0.45636239647865295, 4.328452110290527, -6.8229756355285645),
        (-0.6727098822593689, 0.7324672341346741, -0.10465764999389648)), (
        (-0.025934362784028053, 3.920870780944824, -6.862936973571777),
        (-0.649814248085022, 0.7418937683105469, -0.165333092212677)), (
        (-0.44148850440979004, 3.5918681621551514, -6.788408279418945),
        (-0.5784900188446045, 0.8016536235809326, -0.15066739916801453)), (
        (-0.9109136462211609, 3.3122401237487793, -6.667520046234131),
        (-0.4645799994468689, 0.8687025308609009, -0.17181746661663055)), (
        (-1.488869309425354, 3.082563638687134, -6.528072834014893),
        (-0.3261314928531647, 0.9138145446777344, -0.24203555285930634)), (
        (-1.9810752868652344, 2.9478609561920166, -6.426019668579102),
        (-0.3017530143260956, 0.8719492554664612, -0.38555097579956055)), (
        (-2.549713134765625, 2.838163137435913, -6.256977081298828),
        (-0.2597988545894623, 0.8345859050750732, -0.4857683777809143)), (
        (-2.877415657043457, 2.81337308883667, -6.157474517822266),
        (-0.19817273318767548, 0.8131222128868103, -0.5473207235336304)), (
        (-4.418260097503662, 2.4745638370513916, -5.932425022125244),
        (-0.21368122100830078, 0.7140989899635315, -0.6666354537010193)), (
        (-4.944849014282227, 2.178593635559082, -6.0721540451049805),
        (-0.1123286783695221, 0.65819251537323, -0.7444225549697876)), (
        (-5.819065570831299, 1.0635372400283813, -6.790013313293457),
        (-0.026998039335012436, 0.37313464283943176, -0.9273843765258789)), (
        (-5.9834160804748535, 0.5899946093559265, -6.960700988769531),
        (-0.006840577814728022, 0.32173702120780945, -0.9468042850494385)), (
        (-6.1041154861450195, -0.012370026670396328, -7.155719757080078),
        (0.010792771354317665, 0.2711871862411499, -0.9624660611152649)), (
        (-6.043765544891357, 0.2888122797012329, -7.058210849761963),
        (0.029855875298380852, 0.3027065694332123, -0.9526160359382629)), (
        (-6.1763916015625, -0.6199460625648499, -7.3055877685546875),
        (0.02716371975839138, 0.18631532788276672, -0.9821144938468933)), (
        (-6.246722221374512, -1.3608505725860596, -7.4096598625183105),
        (0.03637890890240669, 0.03336373716592789, -0.9987809658050537)), (
        (-6.211556911468506, -0.9903982877731323, -7.35762357711792),
        (0.03755226731300354, 0.1374211460351944, -0.9898006319999695)), (
        (-6.301331996917725, -1.787058711051941, -7.383337497711182),
        (0.015318566933274269, -0.11845991760492325, -0.9928406476974487)), (
        (-6.419271945953369, -2.4965991973876953, -7.240077972412109),
        (0.015037225559353828, -0.2934887409210205, -0.9558442234992981)), (
        (-6.360301971435547, -2.141829013824463, -7.311707973480225),
        (0.006118928547948599, -0.19014668464660645, -0.9817365407943726)), (
        (-6.599145412445068, -3.079159736633301, -6.982796669006348),
        (-0.009737036190927029, -0.4078347980976105, -0.9130038022994995)), (
        (-6.509208679199219, -2.787879467010498, -7.111437797546387),
        (-0.03564470633864403, -0.38441306352615356, -0.9224727749824524)), (
        (-6.7654314041137695, -3.571754217147827, -6.749355792999268),
        (-0.008026812225580215, -0.353054404258728, -0.9355683922767639)), (
        (-6.789860725402832, -4.1735005378723145, -6.5872578620910645),
        (0.06277596950531006, -0.23303842544555664, -0.9704391956329346)), (
        (-6.713405132293701, -4.732272148132324, -6.475088119506836),
        (0.11021300405263901, -0.16579803824424744, -0.9799817204475403)), (
        (-6.626896858215332, -5.151517868041992, -6.399052619934082),
        (0.1276441365480423, -0.1538548469543457, -0.9798141121864319)), (
        (-6.523571968078613, -5.68840217590332, -6.296528339385986),
        (0.12063373625278473, -0.16072197258472443, -0.9795998334884644)), (
        (-6.420942783355713, -6.357927322387695, -6.173305034637451),
        (0.10573241859674454, -0.15592677891254425, -0.9820933938026428)), (
        (-6.472257137298584, -6.023164749145508, -6.234916687011719),
        (0.09962990134954453, -0.16825389862060547, -0.9806960225105286)), (
        (-6.376275062561035, -6.941102504730225, -6.081442356109619),
        (0.12143366038799286, -0.11743736267089844, -0.9856278896331787)), (
        (-6.401347637176514, -7.280947685241699, -6.042251110076904),
        (0.03682281821966171, -0.1376897543668747, -0.9897907972335815)), (
        (-6.639857769012451, -8.605504989624023, -5.935605049133301),
        (-0.08424019813537598, -0.051194582134485245, -0.9951294660568237)), (
        (-6.794455051422119, -9.114970207214355, -5.901371479034424),
        (-0.14815568923950195, -0.051581352949142456, -0.9876179099082947)), (
        (-6.939048767089844, -9.53994369506836, -5.856614589691162),
        (-0.20831015706062317, -0.04157144948840141, -0.9771789908409119)), (
        (-7.12832498550415, -10.1124267578125, -5.790027618408203),
        (-0.26673996448516846, -0.06359262019395828, -0.9616681933403015)), (
        (-7.286404609680176, -10.671957015991211, -5.700556755065918),
        (-0.3111650347709656, -0.09248371422290802, -0.9458451271057129)), (
        (-7.4928812980651855, -11.982843399047852, -5.37400484085083),
        (-0.39565637707710266, -0.34899064898490906, -0.8495066165924072)), (
        (-7.456944465637207, -11.637713432312012, -5.480640411376953),
        (-0.3385273218154907, -0.2633456587791443, -0.9033539295196533)), (
        (-7.440666198730469, -12.632780075073242, -5.041562557220459),
        (-0.37046825885772705, -0.5083370804786682, -0.7773973941802979)), (
        (-7.466773986816406, -12.30781078338623, -5.207783222198486),
        (-0.34152472019195557, -0.4302739202976227, -0.8355987668037415)), (
        (-7.148633003234863, -12.610745429992676, -4.854461669921875),
        (0.5357465744018555, -0.2892284691333771, -0.7932984828948975)), (
        (-7.216585636138916, -13.163357734680176, -4.714267730712891),
        (-0.3458242118358612, -0.5994776487350464, -0.7218255400657654)), (
        (-7.328625679016113, -12.89806842803955, -4.877914905548096),
        (-0.28771576285362244, -0.5952732563018799, -0.7502462267875671)), (
        (-6.507818698883057, -13.83551025390625, -4.3201704025268555),
        (-0.20015400648117065, -0.7419414520263672, -0.6398915648460388)), (
        (-5.997337341308594, -14.053603172302246, -4.209532260894775),
        (-0.14960400760173798, -0.7696647644042969, -0.6206728219985962)), (
        (-5.571229457855225, -14.159418106079102, -4.154720783233643),
        (-0.08077661693096161, -0.7975022792816162, -0.5978839993476868)), (
        (-4.991879940032959, -14.203085899353027, -4.135111331939697),
        (-0.024426737800240517, -0.8000279664993286, -0.5994653105735779)), (
        (-4.406278133392334, -14.18621826171875, -4.198268890380859),
        (-0.07654794305562973, -0.7841626405715942, -0.6158159375190735)), (
        (-3.850712537765503, -14.159637451171875, -4.334346294403076),
        (-0.13111966848373413, -0.7979528307914734, -0.5882848501205444)), (
        (-3.163975954055786, -14.081354141235352, -4.6285786628723145),
        (-0.15644069015979767, -0.789043664932251, -0.5940845012664795)), (
        (-3.5073440074920654, -14.120495796203613, -4.481462478637695),
        (-0.17341552674770355, -0.7698686122894287, -0.6141899824142456)), (
        (-2.5729470252990723, -13.966147422790527, -4.914556503295898),
        (-0.10618529468774796, -0.7841417193412781, -0.6114299297332764)), (
        (-2.8684613704681396, -14.023750305175781, -4.7715678215026855),
        (-0.13743393123149872, -0.7750697731971741, -0.6167485117912292)), (
        (-2.0606541633605957, -13.82714557647705, -5.128925323486328),
        (-0.01161906123161316, -0.751783549785614, -0.6593075394630432)), (
        (-1.6228026151657104, -13.67015552520752, -5.272737503051758),
        (0.08422212302684784, -0.6970829367637634, -0.7120267152786255)), (
        (-1.1591249704360962, -13.477304458618164, -5.353235721588135),
        (0.24110302329063416, -0.6220942139625549, -0.7448947429656982)), (
        (-0.6723743081092834, -13.225735664367676, -5.3172993659973145),
        (0.401067316532135, -0.5265950560569763, -0.7495617270469666)), (
        (-0.12990543246269226, -12.904779434204102, -5.14794397354126),
        (0.5166665315628052, -0.44158196449279785, -0.7335264682769775)), (
        (-0.40113988518714905, -13.06525707244873, -5.232621669769287),
        (0.48644858598709106, -0.48802700638771057, -0.724705159664154)), (
        (0.5172716379165649, -12.52586841583252, -4.893607139587402),
        (0.5196179151535034, -0.39470726251602173, -0.7577620148658752)), (
        (0.19368310272693634, -12.715323448181152, -5.020775318145752),
        (0.5193719863891602, -0.42601102590560913, -0.7407883405685425)), (
        (1.0811249017715454, -12.224574089050293, -4.6774163246154785),
        (0.48065048456192017, -0.3757692277431488, -0.7923210859298706)), (
        (0.7991982698440552, -12.375221252441406, -4.785511493682861),
        (0.4976973235607147, -0.389376163482666, -0.7750378251075745)), (
        (1.448569655418396, -12.042891502380371, -4.544405937194824),
        (0.4587419331073761, -0.3678062856197357, -0.8088722229003906)), (
        (2.1137490272521973, -11.725000381469727, -4.330318927764893),
        (0.39153853058815, -0.32184112071990967, -0.8620416522026062)), (
        (1.7811592817306519, -11.883946418762207, -4.4373626708984375),
        (0.42214179039001465, -0.3474905788898468, -0.8372852206230164)), (
        (2.6960151195526123, -11.486844062805176, -4.180538177490234),
        (0.33181145787239075, -0.28369849920272827, -0.8996756672859192)), (
        (2.4048821926116943, -11.605921745300293, -4.255428791046143),
        (0.34509503841400146, -0.3126790225505829, -0.88495272397995)), (
        (3.177689552307129, -11.326494216918945, -4.064032554626465),
        (0.2750304341316223, -0.24273847043514252, -0.9302882552146912)), (
        (4.841940402984619, -11.076727867126465, -3.86128830909729),
        (0.002391292480751872, -0.20457376539707184, -0.9788482785224915)), (
        (5.318578720092773, -11.048727989196777, -3.8875396251678467),
        (-0.06495228409767151, -0.2084806114435196, -0.9758673906326294)), (
        (5.822727680206299, -11.007675170898438, -3.941732168197632),
        (-0.08998636901378632, -0.1919126659631729, -0.9772778749465942)), (
        (6.2316508293151855, -10.967765808105469, -3.990170955657959),
        (-0.10376172512769699, -0.19490495324134827, -0.9753182530403137)), (
        (6.739208221435547, -10.8900146484375, -4.064700126647949),
        (-0.10482285171747208, -0.17200849950313568, -0.9795025587081909)), (
        (7.25075101852417, -10.796920776367188, -4.134873867034912),
        (-0.10809451341629028, -0.18008945882320404, -0.9776929020881653)), (
        (7.718608379364014, -10.668254852294922, -4.216110706329346),
        (-0.10383804142475128, -0.1749916672706604, -0.9790789484977722)), (
        (8.162903785705566, -10.519841194152832, -4.282898426055908),
        (-0.08059731870889664, -0.18720939755439758, -0.9790080189704895)), (
        (10.016336441040039, -9.236197471618652, -4.59490442276001),
        (-0.07603146880865097, -0.13105230033397675, -0.988455593585968)), (
        (10.442526817321777, -8.835067749023438, -4.6831817626953125),
        (-0.09234017878770828, -0.1387050896883011, -0.9860193729400635)), (
        (10.850831985473633, -8.453397750854492, -4.78000020980835),
        (-0.14779233932495117, -0.15781202912330627, -0.9763467311859131)), (
        (11.232985496520996, -8.126579284667969, -4.904430866241455),
        (-0.14421923458576202, -0.21504716575145721, -0.9658963084220886)), (
        (11.60472297668457, -7.821676254272461, -5.038125514984131),
        (-0.12136989831924438, -0.25396019220352173, -0.95956951379776)), (
        (11.929610252380371, -7.558956146240234, -5.158660411834717),
        (-0.11657946556806564, -0.29084768891334534, -0.9496403932571411)), (
        (12.351286888122559, -7.207352161407471, -5.312367916107178),
        (-0.07718303054571152, -0.30992624163627625, -0.947622537612915))
    ]

def recover_and_remind_border():
    '''
    恢复到进入切割模式并且保留边界线，用于挖孔，切割报错时恢复
    '''
    recover_flag = False
    for obj in bpy.context.view_layer.objects:
        if obj.name == "右耳OriginForCreateMouldR":
            recover_flag = True
            break
    # 找到最初创建的  OriginForCreateMould 才能进行恢复
    if recover_flag:
        # 删除不需要的物体
        need_to_delete_model_name_list = ["右耳", "HoleCutCylinderBottomR", "cutPlane", "右耳OriginForCutR",
                                          "右耳OriginForFill"]
        for selected_obj in bpy.data.objects:
            if (selected_obj.name in need_to_delete_model_name_list):
                bpy.data.objects.remove(selected_obj, do_unlink=True)
            bpy.ops.outliner.orphans_purge(
                do_local_ids=True, do_linked_ids=True, do_recursive=False)
        # 将最开始复制出来的OriginForCreateMould名称改为模型名称
        obj.hide_set(False)
        obj.name = "右耳"

        bpy.context.view_layer.objects.active = obj
        # 恢复完后重新复制一份
        cur_obj = bpy.context.active_object
        duplicate_obj = cur_obj.copy()
        duplicate_obj.data = cur_obj.data.copy()
        duplicate_obj.animation_data_clear()
        duplicate_obj.name = cur_obj.name + "OriginForCreateMouldR"
        bpy.context.collection.objects.link(duplicate_obj)
        duplicate_obj.hide_set(True)
        # todo 先加到右耳集合，后续调整左右耳适配
        moveToRight(duplicate_obj)


# def apply_frame_style_eardrum_template():
#     # 获取框架式耳膜参数
#     # todo 将来调整模板圆环位置后，要记录调整后的以下两个参数，若有记录，读取记录， 没有则读取套用的模板本身的参数
#     template_highest_point = (-10.3681, 2.2440, 12.1771)
#     template_hole_border = [(3.6963632106781006, 1.4901610612869263, -3.0596837997436523),
#                             (4.024533748626709, 1.8914767503738403, -3.1757700443267822),
#                             (12.843214988708496, -0.8718163967132568, -1.313320279121399),
#                             (2.6411678791046143, 0.5748220086097717, -2.386669874191284),
#                             (2.965087652206421, 0.8165469765663147, -2.6314637660980225),
#                             (2.3731651306152344, 0.39150846004486084, -2.145109176635742),
#                             (12.957918167114258, 0.3651430904865265, -1.4536579847335815),
#                             (12.93639087677002, -0.1488054245710373, -1.4047847986221313),
#                             (3.3082826137542725, 1.1020065546035767, -2.855614423751831),
#                             (1.2946960926055908, -11.398612022399902, 1.6817331314086914),
#                             (0.9249364733695984, -11.130483627319336, 1.729994773864746),
#                             (8.55871295928955, -9.40313720703125, 0.5494974851608276),
#                             (8.253859519958496, -9.740730285644531, 0.6620934009552002),
#                             (12.507063865661621, 3.5011401176452637, -1.4343156814575195),
#                             (12.629599571228027, 3.0158896446228027, -1.4442719221115112),
#                             (12.838188171386719, 2.016106605529785, -1.4517091512680054),
#                             (12.920886039733887, 1.4565234184265137, -1.4722768068313599),
#                             (12.964752197265625, 0.8709620237350464, -1.4785915613174438),
#                             (12.894177436828613, -0.5520572662353516, -1.3555926084518433),
#                             (12.792250633239746, -1.191575527191162, -1.2710481882095337),
#                             (12.665345191955566, -1.7101281881332397, -1.202019453048706),
#                             (12.548029899597168, -2.1346137523651123, -1.1526480913162231),
#                             (12.329446792602539, -2.7304937839508057, -1.0837055444717407),
#                             (12.135722160339355, -3.245666980743408, -1.022111177444458),
#                             (11.993698120117188, -3.6173882484436035, -0.9790816307067871),
#                             (11.820446968078613, -4.023478031158447, -0.9251344799995422),
#                             (11.648019790649414, -4.4161057472229, -0.8655819296836853),
#                             (11.399292945861816, -4.988503932952881, -0.7775691151618958),
#                             (11.146452903747559, -5.531449317932129, -0.6900633573532104),
#                             (10.932639122009277, -5.946956157684326, -0.6179193258285522),
#                             (10.69723892211914, -6.402900695800781, -0.5425477623939514),
#                             (10.414801597595215, -6.877074718475342, -0.44408175349235535),
#                             (10.047009468078613, -7.438182353973389, -0.28980565071105957),
#                             (10.230905532836914, -7.157628059387207, -0.36694368720054626),
#                             (9.725630760192871, -7.912663459777832, -0.12675721943378448),
#                             (9.448588371276855, -8.289192199707031, 0.03424111753702164),
#                             (9.178918838500977, -8.651290893554688, 0.20285460352897644),
#                             (8.807927131652832, -9.10722541809082, 0.42653241753578186),
#                             (7.872547149658203, -10.117976188659668, 0.7865674495697021),
#                             (7.516564846038818, -10.444554328918457, 0.8883602619171143),
#                             (6.861769199371338, -10.914847373962402, 1.0598691701889038),
#                             (7.189167022705078, -10.67970085144043, 0.9741148352622986),
#                             (6.408305644989014, -11.182273864746094, 1.1770790815353394),
#                             (5.931820869445801, -11.413411140441895, 1.2979679107666016),
#                             (5.426996231079102, -11.603611946105957, 1.4154208898544312),
#                             (4.9288201332092285, -11.754626274108887, 1.517586588859558),
#                             (4.3456902503967285, -11.880534172058105, 1.6075023412704468),
#                             (3.7905044555664062, -11.945758819580078, 1.6145703792572021),
#                             (3.295797348022461, -11.95645809173584, 1.614926815032959),
#                             (2.8174421787261963, -11.942265510559082, 1.6223126649856567),
#                             (2.3959758281707764, -11.89465045928955, 1.628889560699463),
#                             (1.8277599811553955, -11.697726249694824, 1.6549468040466309),
#                             (0.6209799647331238, -10.828849792480469, 1.7945162057876587),
#                             (0.25474610924720764, -10.368200302124023, 1.8780310153961182),
#                             (0.04115241765975952, -10.001692771911621, 1.943669080734253),
#                             (-0.15488965809345245, -9.519744873046875, 2.014132022857666),
#                             (-0.2806141972541809, -9.038475036621094, 2.0703227519989014),
#                             (-0.4320831298828125, -8.210223197937012, 2.1518802642822266),
#                             (-0.3563486635684967, -8.624348640441895, 2.1111016273498535),
#                             (-0.5111169219017029, -7.552506446838379, 2.218980073928833),
#                             (-0.4716000258922577, -7.881364345550537, 2.1854300498962402),
#                             (-0.5510504245758057, -7.072164058685303, 2.261087417602539),
#                             (-0.5644205212593079, -6.41131591796875, 2.301321268081665),
#                             (-0.5577354431152344, -6.741740703582764, 2.2812042236328125),
#                             (-0.5188507437705994, -5.70134973526001, 2.3133866786956787),
#                             (-0.5416356325149536, -6.056333065032959, 2.307353973388672),
#                             (-0.44446927309036255, -5.299101829528809, 2.2926900386810303),
#                             (-0.33486518263816833, -4.820234775543213, 2.2214596271514893),
#                             (-0.18607106804847717, -4.31535005569458, 2.0996124744415283),
#                             (-0.05270791053771973, -3.8721120357513428, 1.951110601425171),
#                             (0.0926927924156189, -3.3574347496032715, 1.7276159524917603),
#                             (0.24543948471546173, -2.766591787338257, 1.4007498025894165),
#                             (0.1690661460161209, -3.0620131492614746, 1.5641828775405884),
#                             (0.35218748450279236, -2.353675603866577, 1.1189075708389282),
#                             (0.42767372727394104, -2.082745313644409, 0.9185145497322083),
#                             (0.5506889224052429, -1.6927212476730347, 0.6130993962287903),
#                             (0.6739373207092285, -1.3594837188720703, 0.3363266885280609),
#                             (0.8197004199028015, -0.9980949759483337, 0.013687835074961185),
#                             (0.9898991584777832, -0.7172536253929138, -0.2826230823993683),
#                             (1.1958669424057007, -0.4482511579990387, -0.6342360973358154),
#                             (1.5044136047363281, -0.15686918795108795, -1.0913158655166626),
#                             (1.7636206150054932, 0.01574736088514328, -1.4392938613891602),
#                             (2.0508487224578857, 0.1972091794013977, -1.804146647453308),
#                             (4.282073497772217, 2.4328341484069824, -3.12270188331604),
#                             (4.414315700531006, 2.861362934112549, -3.0006484985351562),
#                             (4.4772772789001465, 3.2650697231292725, -2.82511830329895),
#                             (4.510844707489014, 3.7770605087280273, -2.5967326164245605),
#                             (4.467644691467285, 4.170411109924316, -2.311485528945923),
#                             (4.378695964813232, 4.522683143615723, -2.0483224391937256),
#                             (4.26571798324585, 4.796703338623047, -1.7735249996185303),
#                             (4.131589412689209, 5.086734294891357, -1.464192509651184),
#                             (3.7876899242401123, 5.6696343421936035, -0.7011098265647888),
#                             (3.932565450668335, 5.41098165512085, -1.0380185842514038),
#                             (3.6419053077697754, 6.0005621910095215, -0.3522648513317108),
#                             (3.489401340484619, 6.398372173309326, 0.004454396199434996),
#                             (3.347088575363159, 6.852729797363281, 0.3221167325973511),
#                             (3.185861587524414, 7.368130683898926, 0.606022834777832),
#                             (3.046299695968628, 7.814704895019531, 0.7769927382469177),
#                             (2.928696393966675, 8.311086654663086, 0.9026482105255127),
#                             (2.8672969341278076, 8.945741653442383, 0.9690952301025391),
#                             (2.897996664047241, 8.628413200378418, 0.9358717203140259),
#                             (2.891712188720703, 9.357293128967285, 0.9649021625518799),
#                             (2.969801425933838, 9.796195030212402, 0.9363983273506165),
#                             (3.097370147705078, 10.205504417419434, 0.8732314109802246),
#                             (3.2856178283691406, 10.632874488830566, 0.7777088284492493),
#                             (3.5745866298675537, 11.104231834411621, 0.5956199765205383),
#                             (4.128652572631836, 11.561172485351562, 0.29141369462013245),
#                             (3.8516197204589844, 11.332701683044434, 0.4435167908668518),
#                             (4.762118816375732, 11.825363159179688, 0.04528630152344704),
#                             (4.445385932922363, 11.693267822265625, 0.1683499813079834),
#                             (5.436573505401611, 11.935258865356445, -0.11917311698198318),
#                             (5.099346160888672, 11.880311012268066, -0.03694340959191322),
#                             (6.213705539703369, 11.933711051940918, -0.27600592374801636),
#                             (5.82513952255249, 11.93448543548584, -0.19758953154087067),
#                             (6.88806676864624, 11.800002098083496, -0.39216119050979614),
#                             (6.550886631011963, 11.866856575012207, -0.33408355712890625),
#                             (7.556390285491943, 11.561113357543945, -0.48957374691963196),
#                             (7.22222900390625, 11.680557250976562, -0.44086745381355286),
#                             (8.049548149108887, 11.341865539550781, -0.5583334565162659),
#                             (8.45046329498291, 11.13294506072998, -0.6198112964630127),
#                             (8.814872741699219, 10.910809516906738, -0.6696509718894958),
#                             (9.278361320495605, 10.617928504943848, -0.7709121108055115),
#                             (9.886222839355469, 10.064255714416504, -0.8519656658172607),
#                             (9.582292556762695, 10.341092109680176, -0.8114389181137085),
#                             (10.256876945495605, 9.505382537841797, -0.8454475402832031),
#                             (10.071550369262695, 9.784819602966309, -0.8487065434455872),
#                             (10.476049423217773, 9.050673484802246, -0.8667536973953247),
#                             (10.6874418258667, 8.51396656036377, -0.9210289716720581),
#                             (10.889609336853027, 8.0023832321167, -0.9859399199485779),
#                             (11.088006973266602, 7.5226945877075195, -1.0642449855804443),
#                             (11.335945129394531, 6.902442455291748, -1.1789638996124268),
#                             (11.211976051330566, 7.212568759918213, -1.1216044425964355),
#                             (11.537689208984375, 6.35111665725708, -1.2761951684951782),
#                             (11.753602027893066, 5.7709197998046875, -1.360693097114563),
#                             (11.944221496582031, 5.24810791015625, -1.4160056114196777),
#                             (12.122294425964355, 4.769081115722656, -1.4440431594848633),
#                             (12.339226722717285, 4.112521171569824, -1.4512174129486084),
#                             (12.23076057434082, 4.44080114364624, -1.4476302862167358),
#                             (12.7205810546875, 2.586670398712158, -1.4396191835403442)]
#     try:
#         # 挖孔
#         dig_hole(template_highest_point, template_hole_border)
#
#         high_percent = 0.25
#         bottom_cut(high_percent)
#
#         # 将切割和挖洞后形成的新顶点沿发现向内移动生成面,并得到用于平滑的顶点组
#         getSmoothVertexGroup()
#
#         # 根据内边缘顶点桥接补面生成内壁
#         border_fill()
#
#         applySmooth()
#
#         utils_re_color("右耳", (1, 0.319, 0.133))
#
#     except:
#         recover_and_remind_border()
#         utils_re_color("右耳", (1, 1, 0))

# 2024/2/23 新方案
def apply_frame_style_eardrum_template():
    global border_vert_co_and_normal
    origin_highest_vert = (-10.5040, 2.6564, 11.9506)
    
    # 复制一份模型
    cur_obj = bpy.context.active_object
    duplicate_obj = cur_obj.copy()
    duplicate_obj.data = cur_obj.data.copy()
    duplicate_obj.animation_data_clear()
    duplicate_obj.name = cur_obj.name + "OriginForCutR"
    bpy.context.collection.objects.link(duplicate_obj)
    duplicate_obj.hide_set(True)
    # todo 先加到右耳集合，后续调整左右耳适配
    moveToRight(duplicate_obj)
    try:
        # high_percent = 0.25
        # bottom_cut(high_percent)

        frame_normal_projection_to_darw_cut_plane(origin_highest_vert,border_vert_co_and_normal)
        plane_cut()

        dig_hole()

        fill_frame_style_inner_face()

        convert_to_mesh("BottomRingBorderR", "meshBottomRingBorderR", 0.18)
        utils_re_color("右耳", (1, 0.319, 0.133))

    except:
        recover_and_remind_border()
        utils_re_color("右耳", (1, 1, 0))

def frame_clear_co_and_normal():
    global border_vert_co_and_normal
    border_vert_co_and_normal = [ ]

def frame_set_co_and_normal(co, normal):
    global border_vert_co_and_normal
    border_vert_co_and_normal.append((co, normal))
